AutoItSetOption ("TrayIconDebug", 1)
Opt("WinWaitDelay",100)
Opt("WinDetectHiddenText",1)
Opt("MouseCoordMode",0)
Opt("MouseClickDragDelay",500)
Opt("PixelCoordMode",0)

Func Terminate()
   HotKeySet("{ESC}")
   send("{ESC}")
   HotKeySet("{ESC}", "Terminate")
   exit
EndFunc

$Folder=70

For $Downscale = 1 to 4 step 1
	ControlFocus("Source","Address: C:\Users\mbaeta\Desktop\Source","")
	$WindowName = WinGetHandle("Source","Address: C:\Users\mbaeta\Desktop\Source")
	WinWaitActive("Source","Address: C:\Users\mbaeta\Desktop\Source","")
	ControlClick("Source","Source sibling list",1281)
	MouseMove(164,51)
	MouseClick("left",164,51,4)
	Sleep(1000)
	Send("{Down}")
	MouseMove(164,$Folder)
	MouseClick("left",164,$Folder,1)
	MouseMove(80,80)
	MouseClick("left",80,80,1)
	MouseMove(95,226)
	MouseClick("left",95,226,1)
	Sleep(1000)
	MouseMove(210,147)
	MouseClickDrag("left",210,147,650,200)
	MouseMove(143,48)
	MouseClick("left",143,48)
	WinActivate("frmMain","Merge into one file")
	Sleep(2000)
	MouseMove(389,132)
	Sleep("")
	MouseClick("left",389,132,1)
	Send("{BS}A1{Enter}")
	;ControlSend("frmMain","Merge into one file","[CLASS:TVTEdit; INSTANCE:1]","{Right}A1")
	MouseMove(108,50)
	MouseClick("left",108,50,1)
	WinActivate("frmEditor","Keep Original Aspect Ratio")
	Sleep(490)
	MouseMove(37,300)
	MouseClick("left",37,8,2)
	;ControlFocus("Source","Source sibling list","1001")
	;WinMenuSelectItem("Source","Source sibling list","1283")
	;ControlClick("Source","C:\Users\Mike\Desktop\Source","5")
	;ControlFocus("Source","Source sibling list","[ID:5")
	;Send("{DOWN}")
	;MouseDown(
	;ControlFocus("A1","Source sibling list", "")
	;ControlClick("Source","","[ID:1001]","[CLASS:DropDown; INSTANCE:1]")
	;ControlClick("Source","Source sibling list", "5", "[CLASS:SysListView32; INSTANCE:1]")
	;ControlClick("A1","Organize","")
	;ControlClick("A1","Select All","")>>>>>>>>>>Inserted code below<<<<<<<<<<<<<<<<<<<<
	ControlFocus("frmMain","Merge into one file","")
	;ControlClick("","Merge into one file","[ControlID:1398896; MouseClick:111,46]"}
	MouseMove(389,132)
	Sleep("")
	MouseClick("left",389,132,4)
	ControlSend("frmMain","Merge into one file","","A1")
	MouseMove(108,50)
	MouseClick("left",108,50,1)
	WinWaitActive("frmEditor","Keep Original Aspect Ratio","")
	MouseMove(37,8)
	MouseClick("left",37,8,2)
	;send("95")
	WinActivate("frmEditor","Keep Original Aspect Ratio")
	MouseMove(98,459)
	MouseClick("left",98,459,3)
	Send("{BS}")
	Send("95")
	MouseMove(174,459)
	MouseClick("left",174,459,3)
	Send("{BS}")
	Send("0")
	MouseMove(344,459)
	MouseClick("left",344,459)
	Send("{BS}")
	Send("1242")
	MouseMove(482,459)
	MouseClick("left",482,459,3)
	Send("{BS}")
	Send("996")
	While ControlCommand("frmEditor","Keep Original Aspect Ratio","[CLASS:TRzCheckBox; INSTANCE:1]","Ischecked","") = 0
       ControlClick("frmEditor","Keep Original Aspect Ratio","[CLASS:TRzCheckBox; INSTANCE:1]")
	Wend
		Sleep(1000)
	MouseMove(625,512)
	MouseClick("left",625,512,1)
	WinActivate("frmMain","Merge into one file")
	MouseMove(700,474)
	MouseClick("left",700,474)
	$checksum = PixelChecksum(380,313,414,330)
	While $checksum = PixelChecksum(380,313,414,330)
		Sleep(1000)
	WEnd
	WinActivate("frmConverter","Shut down computer after conversion")
	WinWait("frmConverter","")
	$checksum = PixelChecksum(380,313,414,330)

	; Wait for the region to change, the region is checked every 100ms to reduce CPU load
	While $checksum = PixelChecksum(380,313,414,330)
		Sleep(1000)
	WEnd
	MouseMove(395,324)
	Mouseclick("left",395,324)
	MouseMove(348,399)
	MouseClick("left",348,399)
	$Folder+=20
	
	ControlFocus("Source","Address: C:\Users\mbaeta\Desktop\Source",1001)
	MouseClick("left",164,51)
Next
Exit

