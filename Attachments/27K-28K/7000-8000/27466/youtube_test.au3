#include "WinINet.au3"

Global $developer_key = "AI39si7yt3W32KA9VnJw6Bw4lchzGW5bYCHEpqchv8N0LM_J7Y-33xqck1gTzYwMzpkIed-DWWgv5tTZ95Qpb9XLARCuBO19jQ" ; Required
Global $Descriptor = "AutoIt Test" ; Something to describe the program for loggin purposes
;

$internet = _WinINet_InternetOpen()

;Example XML
$xml = '<?xml version="1.0"?>' & @CRLF
$xml &= '<entry xmlns="http://www.w3.org/2005/Atom"' & @CRLF
$xml &= '  xmlns:media="                             "' & @CRLF
$xml &= '  xmlns:yt="http://gdata.youtube.com/schemas/2007">' & @CRLF
$xml &= '  <media:group>' & @CRLF
$xml &= '    <media:title type="plain">Bad Wedding Toast</media:title>' & @CRLF
$xml &= '    <media:description type="plain">' & @CRLF
$xml &= '      I gave a bad toast at my friend''s wedding.' & @CRLF
$xml &= '    </media:description>' & @CRLF
$xml &= '    <media:category' & @CRLF
$xml &= '      scheme="http://gdata.youtube.com/schemas/2007/categories.cat">People' & @CRLF
$xml &= '    </media:category>' & @CRLF
$xml &= '    <media:keywords>toast, wedding</media:keywords>' & @CRLF
$xml &= '  </media:group>' & @CRLF
$xml &= '</entry>'

$auth_token = _YouTube_Login("", "", $Descriptor)

ConsoleWrite(_YouTube_Upload($auth_token, $developer_key, "C:\Documents and Settings\francisb\dwhelper\Flipping_thundercat_at_100km_h.flv", $xml))

Func _YouTube_Upload($auth_token, $developer_key, $szPath, $sXML)
	If $internet == 0 Then
		MsgBox(0, "Error", "Setup Error")
	EndIf

	$boundary_string = _RandString(8)
	$file_name = StringRight($szPath, StringLen($szPath) - StringInStr($szPath, "\", 0, -1))
	$ext = StringRight ($file_name, StringLen ($file_name) - StringInStr ($file_name, ".", 1, -1))
	MsgBox (0, "", $ext)

	$file_mime = _FIleGetMimeType($ext)
	If $file_mime = -1 Then $file_mime = "application/octet-stream"

	$fHandle = FileOpen($szPath, 16)
	$file_binary = FileRead($fHandle)
	FileClose($fHandle)

	$content = "--" & $boundary_string & @CRLF
	$content &= "Content-Type: application/atom+xml; charset=UTF-8" & @CRLF
	$content &= @CRLF
	$content &= $sXML & @CRLF
	$content &= "--" & $boundary_string
	$content &= "Content-Type: " & $file_mime & @CRLF
	$content &= "Content-Transfer-Encoding: binary" & @CRLF
	$content &= @CRLF
	$content &= $file_binary & @CRLF
	$content &= "--" & $boundary_string & "--" & @CRLF
	$content &= @CRLF
	$length = StringLen($content)

	$header = "Authorization: AuthSub token=""" & $auth_token & """" & @CRLF
	$header &= "GData-Version: 2" & @CRLF
	$header &= "X-GData-Key: key=" & $developer_key & @CRLF
	$header &= "Slug: " & $file_name & @CRLF
	$header &= "Content-Type: multipart/related; boundary=""" & $boundary_string & """" & @CRLF
	$header &= "Content-Length: " & $length & @CRLF
	$header &= "Connection: close" & @CRLF

	$host = "uploads.gdata.youtube.com"
	$internetconnect = _WinINet_InternetConnect($internet, $INTERNET_SERVICE_HTTP, $host, 443)
	If @error Then MsgBox(0, "Error", "Error 2")

	$httprequest = _WinINet_HttpOpenRequest($internetconnect, "POST", "/feeds/api/users/default/uploads", $INTERNET_FLAG_SECURE)

	$addheader = _WinINet_HttpAddRequestHeaders($httprequest, $header, $HTTP_ADDREQ_FLAG_ADD)

	$sendrequest = _WinINet_HttpSendRequest($httprequest, Default, StringToBinary ($content))

	Local $readfile = Binary("")
	Do
		$readfile &= _WinINet_InternetReadFile($httprequest, 5000)
	Until @error <> 0 Or Not @extended
	$ret = BinaryToString($readfile)
	_WinINet_InternetCloseHandle($internetconnect)
	Return $ret
EndFunc   ;==>_YouTube_Upload

Func _RandString($iLength)
	$out = ""
	For $i = 1 To $iLength
		$what = Random(0, 2, 1)
		If $what = 0 Then ;Number
			$chr = Random(48, 57, 1)
		ElseIf $what = 1 Then;Caps Letter
			$chr = Random(65, 90, 1)
		Else ;= 2, Lowercase letter
			$chr = Random(97, 122, 1)
		EndIf
		$out &= Chr($chr)
	Next
	Return $out
EndFunc   ;==>_RandString

Func _FIleGetMimeType ($ext)
	Switch StringUpper ($ext)
		Case "3dm"
			Return "x-world/x-3dmf"
		Case "3dmf"
			Return "x-world/x-3dmf"
		Case "a"
			Return "application/octet-stream"
		Case "aab"
			Return "application/x-authorware-bin"
		Case "aam"
			Return "application/x-authorware-map"
		Case "aas"
			Return "application/x-authorware-seg"
		Case "abc"
			Return "text/vnd.abc"
		Case "acgi"
			Return "text/html"
		Case "afl"
			Return "video/animaflex"
		Case "ai"
			Return "application/postscript"
		Case "aif"
			Return "audio/aiff"
		Case "aif"
			Return "audio/x-aiff"
		Case "aifc"
			Return "audio/aiff"
		Case "aifc"
			Return "audio/x-aiff"
		Case "aiff"
			Return "audio/aiff"
		Case "aiff"
			Return "audio/x-aiff"
		Case "aim"
			Return "application/x-aim"
		Case "aip"
			Return "text/x-audiosoft-intra"
		Case "ani"
			Return "application/x-navi-animation"
		Case "aos"
			Return "application/x-nokia-9000-communicator-add-on-software"
		Case "aps"
			Return "application/mime"
		Case "arc"
			Return "application/octet-stream"
		Case "arj"
			Return "application/arj"
		Case "arj"
			Return "application/octet-stream"
		Case "art"
			Return "image/x-jg"
		Case "asf"
			Return "video/x-ms-asf"
		Case "asm"
			Return "text/x-asm"
		Case "asp"
			Return "text/asp"
		Case "asx"
			Return "application/x-mplayer2"
		Case "asx"
			Return "video/x-ms-asf"
		Case "asx"
			Return "video/x-ms-asf-plugin"
		Case "au"
			Return "audio/basic"
		Case "au"
			Return "audio/x-au"
		Case "avi"
			Return "application/x-troff-msvideo"
		Case "avi"
			Return "video/avi"
		Case "avi"
			Return "video/msvideo"
		Case "avi"
			Return "video/x-msvideo"
		Case "avs"
			Return "video/avs-video"
		Case "bcpio"
			Return "application/x-bcpio"
		Case "bin"
			Return "application/mac-binary"
		Case "bin"
			Return "application/macbinary"
		Case "bin"
			Return "application/octet-stream"
		Case "bin"
			Return "application/x-binary"
		Case "bin"
			Return "application/x-macbinary"
		Case "bm"
			Return "image/bmp"
		Case "bmp"
			Return "image/bmp"
		Case "bmp"
			Return "image/x-windows-bmp"
		Case "boo"
			Return "application/book"
		Case "book"
			Return "application/book"
		Case "boz"
			Return "application/x-bzip2"
		Case "bsh"
			Return "application/x-bsh"
		Case "bz"
			Return "application/x-bzip"
		Case "bz2"
			Return "application/x-bzip2"
		Case "c"
			Return "text/plain"
		Case "c"
			Return "text/x-c"
		Case "c++"
			Return "text/plain"
		Case "cat"
			Return "application/vnd.ms-pki.seccat"
		Case "cc"
			Return "text/plain"
		Case "cc"
			Return "text/x-c"
		Case "ccad"
			Return "application/clariscad"
		Case "cco"
			Return "application/x-cocoa"
		Case "cdf"
			Return "application/cdf"
		Case "cdf"
			Return "application/x-cdf"
		Case "cdf"
			Return "application/x-netcdf"
		Case "cer"
			Return "application/pkix-cert"
		Case "cer"
			Return "application/x-x509-ca-cert"
		Case "cha"
			Return "application/x-chat"
		Case "chat"
			Return "application/x-chat"
		Case "class"
			Return "application/java"
		Case "class"
			Return "application/java-byte-code"
		Case "class"
			Return "application/x-java-class"
		Case "com"
			Return "application/octet-stream"
		Case "com"
			Return "text/plain"
		Case "conf"
			Return "text/plain"
		Case "cpio"
			Return "application/x-cpio"
		Case "cpp"
			Return "text/x-c"
		Case "cpt"
			Return "application/mac-compactpro"
		Case "cpt"
			Return "application/x-compactpro"
		Case "cpt"
			Return "application/x-cpt"
		Case "crl"
			Return "application/pkcs-crl"
		Case "crl"
			Return "application/pkix-crl"
		Case "crt"
			Return "application/pkix-cert"
		Case "crt"
			Return "application/x-x509-ca-cert"
		Case "crt"
			Return "application/x-x509-user-cert"
		Case "csh"
			Return "application/x-csh"
		Case "csh"
			Return "text/x-script.csh"
		Case "css"
			Return "application/x-pointplus"
		Case "css"
			Return "text/css"
		Case "cxx"
			Return "text/plain"
		Case "dcr"
			Return "application/x-director"
		Case "deepv"
			Return "application/x-deepv"
		Case "def"
			Return "text/plain"
		Case "der"
			Return "application/x-x509-ca-cert"
		Case "dif"
			Return "video/x-dv"
		Case "dir"
			Return "application/x-director"
		Case "dl"
			Return "video/dl"
		Case "dl"
			Return "video/x-dl"
		Case "doc"
			Return "application/msword"
		Case "dot"
			Return "application/msword"
		Case "dp"
			Return "application/commonground"
		Case "drw"
			Return "application/drafting"
		Case "dump"
			Return "application/octet-stream"
		Case "dv"
			Return "video/x-dv"
		Case "dvi"
			Return "application/x-dvi"
		Case "dwf"
			Return "drawing/x-dwf (old)"
		Case "dwf"
			Return "model/vnd.dwf"
		Case "dwg"
			Return "application/acad"
		Case "dwg"
			Return "image/vnd.dwg"
		Case "dwg"
			Return "image/x-dwg"
		Case "dxf"
			Return "application/dxf"
		Case "dxf"
			Return "image/vnd.dwg"
		Case "dxf"
			Return "image/x-dwg"
		Case "dxr"
			Return "application/x-director"
		Case "el"
			Return "text/x-script.elisp"
		Case "elc"
			Return "application/x-bytecode.elisp (compiled elisp)"
		Case "elc"
			Return "application/x-elc"
		Case "env"
			Return "application/x-envoy"
		Case "eps"
			Return "application/postscript"
		Case "es"
			Return "application/x-esrehber"
		Case "etx"
			Return "text/x-setext"
		Case "evy"
			Return "application/envoy"
		Case "evy"
			Return "application/x-envoy"
		Case "exe"
			Return "application/octet-stream"
		Case "f"
			Return "text/plain"
		Case "f"
			Return "text/x-fortran"
		Case "f77"
			Return "text/x-fortran"
		Case "f90"
			Return "text/plain"
		Case "f90"
			Return "text/x-fortran"
		Case "fdf"
			Return "application/vnd.fdf"
		Case "fif"
			Return "application/fractals"
		Case "fif"
			Return "image/fif"
		Case "fli"
			Return "video/fli"
		Case "fli"
			Return "video/x-fli"
		Case "flo"
			Return "image/florian"
		Case "flx"
			Return "text/vnd.fmi.flexstor"
		Case "fmf"
			Return "video/x-atomic3d-feature"
		Case "for"
			Return "text/plain"
		Case "for"
			Return "text/x-fortran"
		Case "fpx"
			Return "image/vnd.fpx"
		Case "fpx"
			Return "image/vnd.net-fpx"
		Case "frl"
			Return "application/freeloader"
		Case "funk"
			Return "audio/make"
		Case "g"
			Return "text/plain"
		Case "g3"
			Return "image/g3fax"
		Case "gif"
			Return "image/gif"
		Case "gl"
			Return "video/gl"
		Case "gl"
			Return "video/x-gl"
		Case "gsd"
			Return "audio/x-gsm"
		Case "gsm"
			Return "audio/x-gsm"
		Case "gsp"
			Return "application/x-gsp"
		Case "gss"
			Return "application/x-gss"
		Case "gtar"
			Return "application/x-gtar"
		Case "gz"
			Return "application/x-compressed"
		Case "gz"
			Return "application/x-gzip"
		Case "gzip"
			Return "application/x-gzip"
		Case "gzip"
			Return "multipart/x-gzip"
		Case "h"
			Return "text/plain"
		Case "h"
			Return "text/x-h"
		Case "hdf"
			Return "application/x-hdf"
		Case "help"
			Return "application/x-helpfile"
		Case "hgl"
			Return "application/vnd.hp-hpgl"
		Case "hh"
			Return "text/plain"
		Case "hh"
			Return "text/x-h"
		Case "hlb"
			Return "text/x-script"
		Case "hlp"
			Return "application/hlp"
		Case "hlp"
			Return "application/x-helpfile"
		Case "hlp"
			Return "application/x-winhelp"
		Case "hpg"
			Return "application/vnd.hp-hpgl"
		Case "hpgl"
			Return "application/vnd.hp-hpgl"
		Case "hqx"
			Return "application/binhex"
		Case "hqx"
			Return "application/binhex4"
		Case "hqx"
			Return "application/mac-binhex"
		Case "hqx"
			Return "application/mac-binhex40"
		Case "hqx"
			Return "application/x-binhex40"
		Case "hqx"
			Return "application/x-mac-binhex40"
		Case "hta"
			Return "application/hta"
		Case "htc"
			Return "text/x-component"
		Case "htm"
			Return "text/html"
		Case "html"
			Return "text/html"
		Case "htmls"
			Return "text/html"
		Case "htt"
			Return "text/webviewhtml"
		Case "htx"
			Return "text/html"
		Case "ice"
			Return "x-conference/x-cooltalk"
		Case "ico"
			Return "image/x-icon"
		Case "idc"
			Return "text/plain"
		Case "ief"
			Return "image/ief"
		Case "iefs"
			Return "image/ief"
		Case "iges"
			Return "application/iges"
		Case "iges"
			Return "model/iges"
		Case "igs"
			Return "application/iges"
		Case "igs"
			Return "model/iges"
		Case "ima"
			Return "application/x-ima"
		Case "imap"
			Return "application/x-httpd-imap"
		Case "inf"
			Return "application/inf"
		Case "ins"
			Return "application/x-internett-signup"
		Case "ip"
			Return "application/x-ip2"
		Case "isu"
			Return "video/x-isvideo"
		Case "it"
			Return "audio/it"
		Case "iv"
			Return "application/x-inventor"
		Case "ivr"
			Return "i-world/i-vrml"
		Case "ivy"
			Return "application/x-livescreen"
		Case "jam"
			Return "audio/x-jam"
		Case "jav"
			Return "text/plain"
		Case "jav"
			Return "text/x-java-source"
		Case "java"
			Return "text/plain"
		Case "java"
			Return "text/x-java-source"
		Case "jcm"
			Return "application/x-java-commerce"
		Case "jfif"
			Return "image/jpeg"
		Case "jfif"
			Return "image/pjpeg"
		Case "jfif-tbnl"
			Return "image/jpeg"
		Case "jpe"
			Return "image/jpeg"
		Case "jpe"
			Return "image/pjpeg"
		Case "jpeg"
			Return "image/jpeg"
		Case "jpeg"
			Return "image/pjpeg"
		Case "jpg"
			Return "image/jpeg"
		Case "jpg"
			Return "image/pjpeg"
		Case "jps"
			Return "image/x-jps"
		Case "js"
			Return "application/x-javascript"
		Case "js"
			Return "application/javascript"
		Case "js"
			Return "application/ecmascript"
		Case "js"
			Return "text/javascript"
		Case "js"
			Return "text/ecmascript"
		Case "jut"
			Return "image/jutvision"
		Case "kar"
			Return "audio/midi"
		Case "kar"
			Return "music/x-karaoke"
		Case "ksh"
			Return "application/x-ksh"
		Case "ksh"
			Return "text/x-script.ksh"
		Case "la"
			Return "audio/nspaudio"
		Case "la"
			Return "audio/x-nspaudio"
		Case "lam"
			Return "audio/x-liveaudio"
		Case "latex"
			Return "application/x-latex"
		Case "lha"
			Return "application/lha"
		Case "lha"
			Return "application/octet-stream"
		Case "lha"
			Return "application/x-lha"
		Case "lhx"
			Return "application/octet-stream"
		Case "list"
			Return "text/plain"
		Case "lma"
			Return "audio/nspaudio"
		Case "lma"
			Return "audio/x-nspaudio"
		Case "log"
			Return "text/plain"
		Case "lsp"
			Return "application/x-lisp"
		Case "lsp"
			Return "text/x-script.lisp"
		Case "lst"
			Return "text/plain"
		Case "lsx"
			Return "text/x-la-asf"
		Case "ltx"
			Return "application/x-latex"
		Case "lzh"
			Return "application/octet-stream"
		Case "lzh"
			Return "application/x-lzh"
		Case "lzx"
			Return "application/lzx"
		Case "lzx"
			Return "application/octet-stream"
		Case "lzx"
			Return "application/x-lzx"
		Case "m"
			Return "text/plain"
		Case "m"
			Return "text/x-m"
		Case "m1v"
			Return "video/mpeg"
		Case "m2a"
			Return "audio/mpeg"
		Case "m2v"
			Return "video/mpeg"
		Case "m3u"
			Return "audio/x-mpequrl"
		Case "man"
			Return "application/x-troff-man"
		Case "map"
			Return "application/x-navimap"
		Case "mar"
			Return "text/plain"
		Case "mbd"
			Return "application/mbedlet"
		Case "mc$"
			Return "application/x-magic-cap-package-1.0"
		Case "mcd"
			Return "application/mcad"
		Case "mcd"
			Return "application/x-mathcad"
		Case "mcf"
			Return "image/vasa"
		Case "mcf"
			Return "text/mcf"
		Case "mcp"
			Return "application/netmc"
		Case "me"
			Return "application/x-troff-me"
		Case "mht"
			Return "message/rfc822"
		Case "mhtml"
			Return "message/rfc822"
		Case "mid"
			Return "application/x-midi"
		Case "mid"
			Return "audio/midi"
		Case "mid"
			Return "audio/x-mid"
		Case "mid"
			Return "audio/x-midi"
		Case "mid"
			Return "music/crescendo"
		Case "mid"
			Return "x-music/x-midi"
		Case "midi"
			Return "application/x-midi"
		Case "midi"
			Return "audio/midi"
		Case "midi"
			Return "audio/x-mid"
		Case "midi"
			Return "audio/x-midi"
		Case "midi"
			Return "music/crescendo"
		Case "midi"
			Return "x-music/x-midi"
		Case "mif"
			Return "application/x-frame"
		Case "mif"
			Return "application/x-mif"
		Case "mime"
			Return "message/rfc822"
		Case "mime"
			Return "www/mime"
		Case "mjf"
			Return "audio/x-vnd.audioexplosion.mjuicemediafile"
		Case "mjpg"
			Return "video/x-motion-jpeg"
		Case "mm"
			Return "application/base64"
		Case "mm"
			Return "application/x-meme"
		Case "mme"
			Return "application/base64"
		Case "mod"
			Return "audio/mod"
		Case "mod"
			Return "audio/x-mod"
		Case "moov"
			Return "video/quicktime"
		Case "mov"
			Return "video/quicktime"
		Case "movie"
			Return "video/x-sgi-movie"
		Case "mp2"
			Return "audio/mpeg"
		Case "mp2"
			Return "audio/x-mpeg"
		Case "mp2"
			Return "video/mpeg"
		Case "mp2"
			Return "video/x-mpeg"
		Case "mp2"
			Return "video/x-mpeq2a"
		Case "mp3"
			Return "audio/mpeg3"
		Case "mp3"
			Return "audio/x-mpeg-3"
		Case "mp3"
			Return "video/mpeg"
		Case "mp3"
			Return "video/x-mpeg"
		Case "mpa"
			Return "audio/mpeg"
		Case "mpa"
			Return "video/mpeg"
		Case "mpc"
			Return "application/x-project"
		Case "mpe"
			Return "video/mpeg"
		Case "mpeg"
			Return "video/mpeg"
		Case "mpg"
			Return "audio/mpeg"
		Case "mpg"
			Return "video/mpeg"
		Case "mpga"
			Return "audio/mpeg"
		Case "mpp"
			Return "application/vnd.ms-project"
		Case "mpt"
			Return "application/x-project"
		Case "mpv"
			Return "application/x-project"
		Case "mpx"
			Return "application/x-project"
		Case "mrc"
			Return "application/marc"
		Case "ms"
			Return "application/x-troff-ms"
		Case "mv"
			Return "video/x-sgi-movie"
		Case "my"
			Return "audio/make"
		Case "mzz"
			Return "application/x-vnd.audioexplosion.mzz"
		Case "nap"
			Return "image/naplps"
		Case "naplps"
			Return "image/naplps"
		Case "nc"
			Return "application/x-netcdf"
		Case "ncm"
			Return "application/vnd.nokia.configuration-message"
		Case "nif"
			Return "image/x-niff"
		Case "niff"
			Return "image/x-niff"
		Case "nix"
			Return "application/x-mix-transfer"
		Case "nsc"
			Return "application/x-conference"
		Case "nvd"
			Return "application/x-navidoc"
		Case "o"
			Return "application/octet-stream"
		Case "oda"
			Return "application/oda"
		Case "omc"
			Return "application/x-omc"
		Case "omcd"
			Return "application/x-omcdatamaker"
		Case "omcr"
			Return "application/x-omcregerator"
		Case "p"
			Return "text/x-pascal"
		Case "p10"
			Return "application/pkcs10"
		Case "p10"
			Return "application/x-pkcs10"
		Case "p12"
			Return "application/pkcs-12"
		Case "p12"
			Return "application/x-pkcs12"
		Case "p7a"
			Return "application/x-pkcs7-signature"
		Case "p7c"
			Return "application/pkcs7-mime"
		Case "p7c"
			Return "application/x-pkcs7-mime"
		Case "p7m"
			Return "application/pkcs7-mime"
		Case "p7m"
			Return "application/x-pkcs7-mime"
		Case "p7r"
			Return "application/x-pkcs7-certreqresp"
		Case "p7s"
			Return "application/pkcs7-signature"
		Case "part"
			Return "application/pro_eng"
		Case "pas"
			Return "text/pascal"
		Case "pbm"
			Return "image/x-portable-bitmap"
		Case "pcl"
			Return "application/vnd.hp-pcl"
		Case "pcl"
			Return "application/x-pcl"
		Case "pct"
			Return "image/x-pict"
		Case "pcx"
			Return "image/x-pcx"
		Case "pdb"
			Return "chemical/x-pdb"
		Case "pdf"
			Return "application/pdf"
		Case "pfunk"
			Return "audio/make"
		Case "pfunk"
			Return "audio/make.my.funk"
		Case "pgm"
			Return "image/x-portable-graymap"
		Case "pgm"
			Return "image/x-portable-greymap"
		Case "pic"
			Return "image/pict"
		Case "pict"
			Return "image/pict"
		Case "pkg"
			Return "application/x-newton-compatible-pkg"
		Case "pko"
			Return "application/vnd.ms-pki.pko"
		Case "pl"
			Return "text/plain"
		Case "pl"
			Return "text/x-script.perl"
		Case "plx"
			Return "application/x-pixclscript"
		Case "pm"
			Return "image/x-xpixmap"
		Case "pm"
			Return "text/x-script.perl-module"
		Case "pm4"
			Return "application/x-pagemaker"
		Case "pm5"
			Return "application/x-pagemaker"
		Case "png"
			Return "image/png"
		Case "pnm"
			Return "application/x-portable-anymap"
		Case "pnm"
			Return "image/x-portable-anymap"
		Case "pot"
			Return "application/mspowerpoint"
		Case "pot"
			Return "application/vnd.ms-powerpoint"
		Case "pov"
			Return "model/x-pov"
		Case "ppa"
			Return "application/vnd.ms-powerpoint"
		Case "ppm"
			Return "image/x-portable-pixmap"
		Case "pps"
			Return "application/mspowerpoint"
		Case "pps"
			Return "application/vnd.ms-powerpoint"
		Case "ppt"
			Return "application/mspowerpoint"
		Case "ppt"
			Return "application/powerpoint"
		Case "ppt"
			Return "application/vnd.ms-powerpoint"
		Case "ppt"
			Return "application/x-mspowerpoint"
		Case "ppz"
			Return "application/mspowerpoint"
		Case "pre"
			Return "application/x-freelance"
		Case "prt"
			Return "application/pro_eng"
		Case "ps"
			Return "application/postscript"
		Case "psd"
			Return "application/octet-stream"
		Case "pvu"
			Return "paleovu/x-pv"
		Case "pwz"
			Return "application/vnd.ms-powerpoint"
		Case "py"
			Return "text/x-script.phyton"
		Case "pyc"
			Return "applicaiton/x-bytecode.python"
		Case "qcp"
			Return "audio/vnd.qcelp"
		Case "qd3"
			Return "x-world/x-3dmf"
		Case "qd3d"
			Return "x-world/x-3dmf"
		Case "qif"
			Return "image/x-quicktime"
		Case "qt"
			Return "video/quicktime"
		Case "qtc"
			Return "video/x-qtc"
		Case "qti"
			Return "image/x-quicktime"
		Case "qtif"
			Return "image/x-quicktime"
		Case "ra"
			Return "audio/x-pn-realaudio"
		Case "ra"
			Return "audio/x-pn-realaudio-plugin"
		Case "ra"
			Return "audio/x-realaudio"
		Case "ram"
			Return "audio/x-pn-realaudio"
		Case "ras"
			Return "application/x-cmu-raster"
		Case "ras"
			Return "image/cmu-raster"
		Case "ras"
			Return "image/x-cmu-raster"
		Case "rast"
			Return "image/cmu-raster"
		Case "rexx"
			Return "text/x-script.rexx"
		Case "rf"
			Return "image/vnd.rn-realflash"
		Case "rgb"
			Return "image/x-rgb"
		Case "rm"
			Return "application/vnd.rn-realmedia"
		Case "rm"
			Return "audio/x-pn-realaudio"
		Case "rmi"
			Return "audio/mid"
		Case "rmm"
			Return "audio/x-pn-realaudio"
		Case "rmp"
			Return "audio/x-pn-realaudio"
		Case "rmp"
			Return "audio/x-pn-realaudio-plugin"
		Case "rng"
			Return "application/ringing-tones"
		Case "rng"
			Return "application/vnd.nokia.ringing-tone"
		Case "rnx"
			Return "application/vnd.rn-realplayer"
		Case "roff"
			Return "application/x-troff"
		Case "rp"
			Return "image/vnd.rn-realpix"
		Case "rpm"
			Return "audio/x-pn-realaudio-plugin"
		Case "rt"
			Return "text/richtext"
		Case "rt"
			Return "text/vnd.rn-realtext"
		Case "rtf"
			Return "application/rtf"
		Case "rtf"
			Return "application/x-rtf"
		Case "rtf"
			Return "text/richtext"
		Case "rtx"
			Return "application/rtf"
		Case "rtx"
			Return "text/richtext"
		Case "rv"
			Return "video/vnd.rn-realvideo"
		Case "s"
			Return "text/x-asm"
		Case "s3m"
			Return "audio/s3m"
		Case "saveme"
			Return "application/octet-stream"
		Case "sbk"
			Return "application/x-tbook"
		Case "scm"
			Return "application/x-lotusscreencam"
		Case "scm"
			Return "text/x-script.guile"
		Case "scm"
			Return "text/x-script.scheme"
		Case "scm"
			Return "video/x-scm"
		Case "sdml"
			Return "text/plain"
		Case "sdp"
			Return "application/sdp"
		Case "sdp"
			Return "application/x-sdp"
		Case "sdr"
			Return "application/sounder"
		Case "sea"
			Return "application/sea"
		Case "sea"
			Return "application/x-sea"
		Case "set"
			Return "application/set"
		Case "sgm"
			Return "text/sgml"
		Case "sgm"
			Return "text/x-sgml"
		Case "sgml"
			Return "text/sgml"
		Case "sgml"
			Return "text/x-sgml"
		Case "sh"
			Return "application/x-bsh"
		Case "sh"
			Return "application/x-sh"
		Case "sh"
			Return "application/x-shar"
		Case "sh"
			Return "text/x-script.sh"
		Case "shar"
			Return "application/x-bsh"
		Case "shar"
			Return "application/x-shar"
		Case "shtml"
			Return "text/html"
		Case "shtml"
			Return "text/x-server-parsed-html"
		Case "sid"
			Return "audio/x-psid"
		Case "sit"
			Return "application/x-sit"
		Case "sit"
			Return "application/x-stuffit"
		Case "skd"
			Return "application/x-koan"
		Case "skm"
			Return "application/x-koan"
		Case "skp"
			Return "application/x-koan"
		Case "skt"
			Return "application/x-koan"
		Case "sl"
			Return "application/x-seelogo"
		Case "smi"
			Return "application/smil"
		Case "smil"
			Return "application/smil"
		Case "snd"
			Return "audio/basic"
		Case "snd"
			Return "audio/x-adpcm"
		Case "sol"
			Return "application/solids"
		Case "spc"
			Return "application/x-pkcs7-certificates"
		Case "spc"
			Return "text/x-speech"
		Case "spl"
			Return "application/futuresplash"
		Case "spr"
			Return "application/x-sprite"
		Case "sprite"
			Return "application/x-sprite"
		Case "src"
			Return "application/x-wais-source"
		Case "ssi"
			Return "text/x-server-parsed-html"
		Case "ssm"
			Return "application/streamingmedia"
		Case "sst"
			Return "application/vnd.ms-pki.certstore"
		Case "step"
			Return "application/step"
		Case "stl"
			Return "application/sla"
		Case "stl"
			Return "application/vnd.ms-pki.stl"
		Case "stl"
			Return "application/x-navistyle"
		Case "stp"
			Return "application/step"
		Case "sv4cpio"
			Return "application/x-sv4cpio"
		Case "sv4crc"
			Return "application/x-sv4crc"
		Case "svf"
			Return "image/vnd.dwg"
		Case "svf"
			Return "image/x-dwg"
		Case "svr"
			Return "application/x-world"
		Case "svr"
			Return "x-world/x-svr"
		Case "swf"
			Return "application/x-shockwave-flash"
		Case "t"
			Return "application/x-troff"
		Case "talk"
			Return "text/x-speech"
		Case "tar"
			Return "application/x-tar"
		Case "tbk"
			Return "application/toolbook"
		Case "tbk"
			Return "application/x-tbook"
		Case "tcl"
			Return "application/x-tcl"
		Case "tcl"
			Return "text/x-script.tcl"
		Case "tcsh"
			Return "text/x-script.tcsh"
		Case "tex"
			Return "application/x-tex"
		Case "texi"
			Return "application/x-texinfo"
		Case "texinfo"
			Return "application/x-texinfo"
		Case "text"
			Return "application/plain"
		Case "text"
			Return "text/plain"
		Case "tgz"
			Return "application/gnutar"
		Case "tgz"
			Return "application/x-compressed"
		Case "tif"
			Return "image/tiff"
		Case "tif"
			Return "image/x-tiff"
		Case "tiff"
			Return "image/tiff"
		Case "tiff"
			Return "image/x-tiff"
		Case "tr"
			Return "application/x-troff"
		Case "tsi"
			Return "audio/tsp-audio"
		Case "tsp"
			Return "application/dsptype"
		Case "tsp"
			Return "audio/tsplayer"
		Case "tsv"
			Return "text/tab-separated-values"
		Case "turbot"
			Return "image/florian"
		Case "txt"
			Return "text/plain"
		Case "uil"
			Return "text/x-uil"
		Case "uni"
			Return "text/uri-list"
		Case "unis"
			Return "text/uri-list"
		Case "unv"
			Return "application/i-deas"
		Case "uri"
			Return "text/uri-list"
		Case "uris"
			Return "text/uri-list"
		Case "ustar"
			Return "application/x-ustar"
		Case "ustar"
			Return "multipart/x-ustar"
		Case "uu"
			Return "application/octet-stream"
		Case "uu"
			Return "text/x-uuencode"
		Case "uue"
			Return "text/x-uuencode"
		Case "vcd"
			Return "application/x-cdlink"
		Case "vcs"
			Return "text/x-vcalendar"
		Case "vda"
			Return "application/vda"
		Case "vdo"
			Return "video/vdo"
		Case "vew"
			Return "application/groupwise"
		Case "viv"
			Return "video/vivo"
		Case "viv"
			Return "video/vnd.vivo"
		Case "vivo"
			Return "video/vivo"
		Case "vivo"
			Return "video/vnd.vivo"
		Case "vmd"
			Return "application/vocaltec-media-desc"
		Case "vmf"
			Return "application/vocaltec-media-file"
		Case "voc"
			Return "audio/voc"
		Case "voc"
			Return "audio/x-voc"
		Case "vos"
			Return "video/vosaic"
		Case "vox"
			Return "audio/voxware"
		Case "vqe"
			Return "audio/x-twinvq-plugin"
		Case "vqf"
			Return "audio/x-twinvq"
		Case "vql"
			Return "audio/x-twinvq-plugin"
		Case "vrml"
			Return "application/x-vrml"
		Case "vrml"
			Return "model/vrml"
		Case "vrml"
			Return "x-world/x-vrml"
		Case "vrt"
			Return "x-world/x-vrt"
		Case "vsd"
			Return "application/x-visio"
		Case "vst"
			Return "application/x-visio"
		Case "vsw"
			Return "application/x-visio"
		Case "w60"
			Return "application/wordperfect6.0"
		Case "w61"
			Return "application/wordperfect6.1"
		Case "w6w"
			Return "application/msword"
		Case "wav"
			Return "audio/wav"
		Case "wav"
			Return "audio/x-wav"
		Case "wb1"
			Return "application/x-qpro"
		Case "wbmp"
			Return "image/vnd.wap.wbmp"
		Case "web"
			Return "application/vnd.xara"
		Case "wiz"
			Return "application/msword"
		Case "wk1"
			Return "application/x-123"
		Case "wmf"
			Return "windows/metafile"
		Case "wml"
			Return "text/vnd.wap.wml"
		Case "wmlc"
			Return "application/vnd.wap.wmlc"
		Case "wmls"
			Return "text/vnd.wap.wmlscript"
		Case "wmlsc"
			Return "application/vnd.wap.wmlscriptc"
		Case "word"
			Return "application/msword"
		Case "wp"
			Return "application/wordperfect"
		Case "wp5"
			Return "application/wordperfect"
		Case "wp5"
			Return "application/wordperfect6.0"
		Case "wp6"
			Return "application/wordperfect"
		Case "wpd"
			Return "application/wordperfect"
		Case "wpd"
			Return "application/x-wpwin"
		Case "wq1"
			Return "application/x-lotus"
		Case "wri"
			Return "application/mswrite"
		Case "wri"
			Return "application/x-wri"
		Case "wrl"
			Return "application/x-world"
		Case "wrl"
			Return "model/vrml"
		Case "wrl"
			Return "x-world/x-vrml"
		Case "wrz"
			Return "model/vrml"
		Case "wrz"
			Return "x-world/x-vrml"
		Case "wsc"
			Return "text/scriplet"
		Case "wsrc"
			Return "application/x-wais-source"
		Case "wtk"
			Return "application/x-wintalk"
		Case "xbm"
			Return "image/x-xbitmap"
		Case "xbm"
			Return "image/x-xbm"
		Case "xbm"
			Return "image/xbm"
		Case "xdr"
			Return "video/x-amt-demorun"
		Case "xgz"
			Return "xgl/drawing"
		Case "xif"
			Return "image/vnd.xiff"
		Case "xl"
			Return "application/excel"
		Case "xla"
			Return "application/excel"
		Case "xla"
			Return "application/x-excel"
		Case "xla"
			Return "application/x-msexcel"
		Case "xlb"
			Return "application/excel"
		Case "xlb"
			Return "application/vnd.ms-excel"
		Case "xlb"
			Return "application/x-excel"
		Case "xlc"
			Return "application/excel"
		Case "xlc"
			Return "application/vnd.ms-excel"
		Case "xlc"
			Return "application/x-excel"
		Case "xld"
			Return "application/excel"
		Case "xld"
			Return "application/x-excel"
		Case "xlk"
			Return "application/excel"
		Case "xlk"
			Return "application/x-excel"
		Case "xll"
			Return "application/excel"
		Case "xll"
			Return "application/vnd.ms-excel"
		Case "xll"
			Return "application/x-excel"
		Case "xlm"
			Return "application/excel"
		Case "xlm"
			Return "application/vnd.ms-excel"
		Case "xlm"
			Return "application/x-excel"
		Case "xls"
			Return "application/excel"
		Case "xls"
			Return "application/vnd.ms-excel"
		Case "xls"
			Return "application/x-excel"
		Case "xls"
			Return "application/x-msexcel"
		Case "xlt"
			Return "application/excel"
		Case "xlt"
			Return "application/x-excel"
		Case "xlv"
			Return "application/excel"
		Case "xlv"
			Return "application/x-excel"
		Case "xlw"
			Return "application/excel"
		Case "xlw"
			Return "application/vnd.ms-excel"
		Case "xlw"
			Return "application/x-excel"
		Case "xlw"
			Return "application/x-msexcel"
		Case "xm"
			Return "audio/xm"
		Case "xml"
			Return "application/xml"
		Case "xml"
			Return "text/xml"
		Case "xmz"
			Return "xgl/movie"
		Case "xpix"
			Return "application/x-vnd.ls-xpix"
		Case "xpm"
			Return "image/x-xpixmap"
		Case "xpm"
			Return "image/xpm"
		Case "x-png"
			Return "image/png"
		Case "xsr"
			Return "video/x-amt-showrun"
		Case "xwd"
			Return "image/x-xwd"
		Case "xwd"
			Return "image/x-xwindowdump"
		Case "xyz"
			Return "chemical/x-pdb"
		Case "z"
			Return "application/x-compress"
		Case "z"
			Return "application/x-compressed"
		Case "zip"
			Return "application/x-compressed"
		Case "zip"
			Return "application/x-zip-compressed"
		Case "zip"
			Return "application/zip"
		Case "zip"
			Return "multipart/x-zip"
		Case "zoo"
			Return "application/octet-stream"
		Case "zsh"
			Return "text/x-script.zsh"
	EndSwitch
	Return -1
EndFunc

Func _YouTube_Login($sUser, $sPass, $sDescriptor)
	If $internet == 0 Then
		MsgBox(0, "Error", "Setup Error")
	EndIf

	$ip = "www.google.com"
	$internetconnect = _WinINet_InternetConnect($internet, $INTERNET_SERVICE_HTTP, $ip, 443)

	If @error Then MsgBox(0, "Error", "Error 2")


	$data = "Email=" & $sUser & "&Passwd=" & $sPass & "&service=youtube&source=" & $sDescriptor; Data encoded
	$type = "Content-Type: application/x-www-form-urlencoded" & @CRLF
	$agent = "User-Agent: AutoIt/4.0" & @CRLF

	$content = $agent & $type
	;$content = $type

	$httprequest = _WinINet_HttpOpenRequest($internetconnect, "POST", "/youtube/accounts/ClientLogin", $INTERNET_FLAG_SECURE)
	$addheader = _WinINet_HttpAddRequestHeaders($httprequest, $content, $HTTP_ADDREQ_FLAG_ADD)

	$sendrequest = _WinINet_HttpSendRequest($httprequest, Default, StringToBinary($data))
	Local $readfile = Binary("")
	Do
		$readfile &= _WinINet_InternetReadFile($httprequest, 5000)
	Until @error <> 0 Or Not @extended
	$ret = BinaryToString($readfile)
	$array = StringRegExp($ret, '(?i)=(.*?)\s', 3)
	_WinINet_InternetCloseHandle($internetconnect)
	Return $array[0]
EndFunc   ;==>_YouTube_Login
