SELECT
  EDWARD.CLASS_CODE_DESCRIPTION_DIM.CLASS_CODE,
  EDWARD.CLASS_CODE_DESCRIPTION_DIM.CLASS_CODE_STATE,
  sum(nvl(EDWARD.POLICY_TRANSACTION_DETAIL_FACT.PAYROLL_AMOUNT,0)),
  EDWARD.POLICY_DIM.POLICY_NUMBER,
  EDWARD.POLICY_DIM.POLICY_EFFECTIVE_DATE,
  EDWARD.POLICYHOLDER_RISK_STATE_DIM.POLICYHOLDER_NAME,
  EDWARD.CURRENT_LOAD_DATE.CURRENT_LOAD_DATE
FROM
  EDWARD.CLASS_CODE_DESCRIPTION_DIM,
  EDWARD.POLICY_TRANSACTION_DETAIL_FACT,
  EDWARD.POLICY_DIM,
  EDWARD.POLICYHOLDER_RISK_STATE_DIM,
  EDWARD.CURRENT_LOAD_DATE,
  EDWARD.DATE_DAY_DIM  ACCTG_COV_EFF_DATE_DIM
WHERE
  ( ACCTG_COV_EFF_DATE_DIM.DATE_DAY_DIM_KEY=EDWARD.POLICY_TRANSACTION_DETAIL_FACT.ACCOUNT_COV_EFF_DATE_DIM_KEY  )
  AND  ( EDWARD.CLASS_CODE_DESCRIPTION_DIM.CLASS_CODE_DESCRIPTION_DIM_KEY=EDWARD.POLICY_TRANSACTION_DETAIL_FACT.CLASS_CODE_DESCRIPTION_DIM_KEY  )
  AND  ( EDWARD.POLICY_TRANSACTION_DETAIL_FACT.POLICYHOLDER_RISK_ST_DIM_KEY=EDWARD.POLICYHOLDER_RISK_STATE_DIM.POLICYHOLDER_RISK_ST_DIM_KEY  )
  AND  ( EDWARD.POLICY_DIM.POLICY_DIM_KEY=EDWARD.POLICY_TRANSACTION_DETAIL_FACT.POLICY_DIM_KEY  )
  AND  ( EDWARD.CURRENT_LOAD_DATE.CURRENT_FACT_TABLE_NAME='POLICY_TRANSACTION_DETAIL_FACT'  )
  AND  ( ACCTG_COV_EFF_DATE_DIM.DATE_DAY_DIM_KEY<=EDWARD.CURRENT_LOAD_DATE.CURRENT_LOAD_DATE_DIM_KEY  )
  AND  ( EDWARD.POLICY_DIM.ROW_CURRENT_INDICATOR='Y'  )
  AND  ( EDWARD.POLICY_DIM.SOURCE_SYSTEM not in ('UHC','CompWest')  )
  AND  
  (
   TO_NUMBER(TO_CHAR(EDWARD.POLICY_DIM.POLICY_EFFECTIVE_DATE,'SYYYY'))  >=  2007
   AND
   EDWARD.CLASS_CODE_DESCRIPTION_DIM.CLASS_CODE  <>  '9063'
   AND
   EDWARD.POLICY_DIM.POLICY_NUMBER  IN  ('6021003')
   AND
   ( ( EDWARD.CLASS_CODE_DESCRIPTION_DIM.REGULATORY_SURCHARGE_FLAG )='N'  )
   AND
   ( ( EDWARD.CLASS_CODE_DESCRIPTION_DIM.CREDIT_FLAG )='N'  )
  )
GROUP BY
  EDWARD.CLASS_CODE_DESCRIPTION_DIM.CLASS_CODE, 
  EDWARD.CLASS_CODE_DESCRIPTION_DIM.CLASS_CODE_STATE, 
  EDWARD.POLICY_DIM.POLICY_NUMBER, 
  EDWARD.POLICY_DIM.POLICY_EFFECTIVE_DATE, 
  EDWARD.POLICYHOLDER_RISK_STATE_DIM.POLICYHOLDER_NAME, 
  EDWARD.CURRENT_LOAD_DATE.CURRENT_LOAD_DATE
HAVING
  sum(nvl(EDWARD.POLICY_TRANSACTION_DETAIL_FACT.PAYROLL_AMOUNT,0))  <>  0


