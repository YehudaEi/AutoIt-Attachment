<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0050)http://www.neopets.com/neomessages.phtml?type=send -->
<HTML><HEAD><TITLE>Neopets - Send and Receive NeoMessages</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<STYLE>A {
	FONT-SIZE: 10pt; COLOR: #000099; FONT-FAMILY: verdana,arial,helvetica; TEXT-DECORATION: none
}
TD {
	FONT-SIZE: 10pt; COLOR: #000099; FONT-FAMILY: verdana,arial,helvetica; TEXT-DECORATION: none
}
P {
	FONT-SIZE: 10pt; COLOR: #000099; FONT-FAMILY: verdana,arial,helvetica; TEXT-DECORATION: none
}
BODY {
	FONT-SIZE: 10pt; COLOR: #000099; FONT-FAMILY: verdana,arial,helvetica; TEXT-DECORATION: none
}
TD {
	COLOR: black
}
P {
	COLOR: black
}
BODY {
	COLOR: black
}
A:hover {
	COLOR: #990000
}
DIV {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px
}
BODY {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px
}
IMG {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px
}
.sf {
	FONT-SIZE: 7.5pt
}
.smallfont {
	FONT-SIZE: 7.5pt
}
.tt {
	FONT-SIZE: 7.5pt
}
.tl {
	FONT-SIZE: 7.5pt
}
.tt {
	FONT-WEIGHT: bold
}
#ban {
	MARGIN: 0px; WIDTH: 728px; HEIGHT: 90px; BACKGROUND-COLOR: #ffce00
}
#nst {
	BORDER-RIGHT: #000000 1px solid; PADDING-RIGHT: 2px; BORDER-TOP: #000000 1px solid; PADDING-LEFT: 2px; FONT-SIZE: 8pt; PADDING-BOTTOM: 2px; MARGIN: 0px; BORDER-LEFT: #000000 1px solid; WIDTH: 110px; COLOR: #000000; PADDING-TOP: 2px; BORDER-BOTTOM: #000000 1px solid; BACKGROUND-COLOR: #ffff63
}
#ol {
	VISIBILITY: hidden; POSITION: absolute
}
#m {
	BACKGROUND-COLOR: #ffce00
}
#n {
	BACKGROUND-COLOR: #ffce00
}
#mb {
	BACKGROUND-COLOR: #ffce00
}
</STYLE>

<SCRIPT language=JavaScript src="Page_files/n.js"></SCRIPT>

<SCRIPT language=JavaScript><!--
var nl='en',nh=8,nm=36,ns=56,na='am',ncl=new Array(0,53,104,137,169,198,231,265,299,335,368,397,427);
window.setInterval('nc()',1000);
function sh(i){ol.style.clip="rect("+ncl[i-1]+" 128 "+ncl[i]+" 0)";ol.style.visibility='visible'}
function mo(){ol.style.visibility='hidden'};
//-->
</SCRIPT>

<META content="MSHTML 6.00.2900.2769" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff><MAP name=a><AREA onmouseover=sh(1) shape=RECT 
  alt="Create a Neopet" coords=0,10,130,53 
  href="http://www.neopets.com/addpet.phtml"><AREA onmouseover=sh(2) shape=RECT 
  alt="Pet Central" coords=0,53,130,104 
  href="http://www.neopets.com/petcentral.phtml"><AREA onmouseover=sh(3) 
  shape=RECT alt=Explore coords=0,104,130,137 
  href="http://www.neopets.com/explore.phtml"><AREA onmouseover=sh(4) shape=RECT 
  alt=Games coords=0,137,130,169 
  href="http://www.neopets.com/gameroom.phtml"><AREA onmouseover=sh(5) 
  shape=RECT alt=Neomail coords=0,169,130,198 
  href="http://www.neopets.com/neomessages.phtml"><AREA onmouseover=sh(6) 
  shape=RECT alt=Shops coords=0,198,130,231 
  href="http://www.neopets.com/objects.phtml"><AREA onmouseover=sh(7) shape=RECT 
  alt=Neoboards coords=0,231,130,265 
  href="http://www.neopets.com/neoboards/index.phtml"><AREA onmouseover=sh(8) 
  shape=RECT alt=News coords=0,265,130,299 
  href="http://www.neopets.com/nf.phtml"><AREA onmouseover=sh(9) shape=RECT 
  alt=Stuff coords=0,299,130,335 href="http://www.neopets.com/stuff.phtml"><AREA 
  onmouseover=sh(10) shape=RECT alt=Help coords=0,335,130,368 
  href="http://www.neopets.com/help.phtml"><AREA onmouseover=sh(11) shape=RECT 
  alt=Login coords=0,368,130,397 
  href="http://www.neopets.com/loginpage.phtml"><AREA onmouseover=sh(12) 
  shape=RECT alt=Logout coords=0,397,130,427 
  href="http://www.neopets.com/logout.phtml"></MAP>
<DIV id=ban align=center><!--burst_728_468_18--><!-- BEGIN RICH-MEDIA BURST! CODE -->
<SCRIPT language=JavaScript>
rnum=Math.round(Math.random() * 100000);

document.write('<scr'+'ipt src="http://www.burstnet.com/cgi-bin/ads/ad11233b.cgi/v=2.0S/sz=468x60A|728x90A/'+rnum+'/NI/RETURN-CODE/JS/"></scr'+'ipt>');

</SCRIPT>
<NOSCRIPT><A 
href="http://www.burstnet.com/ads/ad11233b-map.cgi/ns/v=2.0S/sz=468x60A|728x90A/" 
target=_top><IMG alt="Click Here" src="" border=0></A> </NOSCRIPT><!-- END BURST CODE --></DIV>
<TABLE height=44 cellSpacing=0 cellPadding=0 width=728 
background=Page_files/hdr.gif border=0>
  <TBODY>
  <TR>
    <TD height=2></TD></TR>
  <TR>
    <TD width=130><A href="http://www.neopets.com/">
      <DIV style="CURSOR: hand; HEIGHT: 34px"></DIV></A></TD>
    <TD vAlign=center align=right>
      <TABLE cellPadding=2 align=right valign="middle">
        <TBODY>
        <TR>
          <TD class=tt>Welcome, <A class=tl 
            href="http://www.neopets.com/randomfriend.phtml?user=corpsecamper_1">corpsecamper_1</A> 
            | Pet : <A class=tl 
            href="http://www.neopets.com/quickref.phtml">Eviscerate010</A> | NP 
            : <A class=tl 
            href="http://www.neopets.com/objects.phtml?type=inventory">250</A> 
          </TD></TR></TBODY></TABLE></TD>
    <TD width=10></TD>
  <TR>
    <TD height=8></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD vAlign=top width=128><IMG id=ol onmouseout=mo() 
            src="Page_files/m5on.gif" useMap=#a border=0> <IMG id=m height=427 
            src="Page_files/m5.gif" width=128 useMap=#a border=0>
            <DIV>
            <TABLE id=n cellSpacing=0 cellPadding=0 width=128>
              <TBODY>
              <TR>
                <TD class=tl align=middle height=277><BR><SPAN id=nst>8:36:56 
                  am NST</SPAN><BR><BR>
                  <FORM action=/search.phtml method=post>Search Neopets: <INPUT 
                  size=7 name=s> <INPUT style="FONT-SIZE: 8pt" type=submit value=Go!></FORM>
                  <OBJECT id=myFlash 
                  codeBase=http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0 
                  height=60 width=120 
                  classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000><PARAM NAME="movie" VALUE="http://images.neopets.com/buttons/570_1_v2.swf"><PARAM NAME="menu" VALUE="false"><PARAM NAME="scale" VALUE="exactfit">
                  <embed src="http://images.neopets.com/buttons/570_1_v2.swf" 
                  pluginspage="http://www.macromedia.com/go/getflashplayer" 
                  type="application/x-shockwave-flash" scale=exactfit width=120 
                  height=60 name="myFlash" 
                  swLiveConnect="true"></embed></OBJECT><BR><BR>
                  <FORM action=/neomessages.phtml?type=send method=post>Select 
                  language: <SELECT style="FONT-SIZE: 8pt" name=lang><OPTION 
                    value=en selected>English</OPTION><OPTION 
                    value=nl>Nederlands</OPTION><OPTION 
                    value=pt>Português</OPTION><OPTION 
                    value=de>Deutsch</OPTION><OPTION 
                    value=fr>Français</OPTION><OPTION 
                    value=it>Italiano</OPTION><OPTION 
                    value=es>Español</OPTION><OPTION 
                    value=ch>简体中文</OPTION><OPTION value=zh>繁體中文</OPTION><OPTION 
                    value=ja>日本語</OPTION><OPTION value=ko>한국어</OPTION></SELECT> <INPUT style="FONT-SIZE: 8pt" type=submit value=Go!></FORM><A 
                  class=tl href="http://www.neopets.com/linktous.phtml">link to 
                  us</A></TD></TR></TBODY></TABLE></DIV></TD>
          <TD width=2 bgColor=black></TD></TR></TBODY></TABLE><IMG id=mb height=20 
      src="Page_files/1.gif" width=130 border=0> </TD>
    <SCRIPT language=JavaScript>var ol = document.getElementById('ol');</SCRIPT>

    <TD onmouseover=mo() 
    style="PADDING-RIGHT: 5px; PADDING-LEFT: 10px; PADDING-BOTTOM: 5px; WIDTH: 595px; PADDING-TOP: 0px" 
    vAlign=top>
      <TABLE border=0>
        <TBODY>
        <TR>
          <TD width=80></TD>
          <TD align=right><IMG class=hdr height=62 
            alt="Neopets - Send and Receive NeoMessages" 
            src="Page_files/neomessages.gif" 
      width=480></TD></TR></TBODY></TABLE><BR><BR clear=all>
      <SCRIPT language=JavaScript type=text/javascript>
	// Cross-Browser Rich Text Editor
	// http://www.kevinroth.com/rte/demo.htm
	// Written by Kevin Roth (kevin@NOSPAMkevinroth.com - remove NOSPAM)
	
	//init variables
	var isRichText = false;
	var rng;
	var currentRTE;
	var allRTEs = "";
	
	var isIE;
	var isGecko;
	var isSafari;
	
	var imagesPath;
	var includesPath;
	var cssFile;
	
	
	function initRTE(imgPath, incPath, css) {
		//set browser vars
		var ua = navigator.userAgent.toLowerCase();
		isIE = ((ua.indexOf("msie") != -1) && (ua.indexOf("opera") == -1) && (ua.indexOf("webtv") == -1)); 
		isGecko = (ua.indexOf("gecko") != -1);

		isSafari = (ua.indexOf("safari") != -1);

		//check to see if designMode mode is available
		if (document.getElementById && document.designMode && !isSafari) {
			isRichText = true;
		}
		else {
		  // redundant, but necessary for Safari
		  isRichText = false;
		}

		
		//set paths vars
		imagesPath = imgPath;
		includesPath = incPath;
		cssFile = css;
		
		//for testing standard textarea, uncomment the following line
		//isRichText = false;
		return true;
	}
	
	function writeRichText(rte, html, width, height, buttons, readOnly) {
	  if (isRichText) {
			if (allRTEs.length > 0) allRTEs += ";";
			allRTEs += rte;
			writeRTE(rte, html, width, height, buttons, readOnly);
		} else {
			writeDefault(rte, html, width, height, buttons, readOnly);
		}
	}
	
	function writeDefault(rte, html, width, height, buttons, readOnly) {
		if (!readOnly) {
			document.writeln('<textarea name="' + rte + '" id="' + rte + '" style="width: ' + width + 'px; height: ' + height + 'px;">' + html + '</textarea>');
		} else {
			document.writeln('<textarea name="' + rte + '" id="' + rte + '" style="width: ' + width + 'px; height: ' + height + 'px;" readonly>' + html + '</textarea>');
		}
	}
	
	function writeRTE(rte, html, width, height, buttons, readOnly) {
		if (readOnly) buttons = false;
		if (buttons == true) {
			document.writeln('<style type="text/css">');
			document.writeln('.btnImage {cursor: pointer; cursor: hand;}');
			document.writeln('</style>');
			

			
			document.writeln('<table id="Buttons1_' + rte + '">');
			document.writeln('	<tr>');
			document.writeln('			<input type="hidden" id="formatblock_' + rte + '" value="<p>">');
			
						document.writeln('		<td>');
			document.writeln('			<select id="fontname_' + rte + '" onchange="Select(\'' + rte + '\', this.id)">');
			document.writeln('				<option value="Font" selected>Font</option>');
			document.writeln('				<option value="Arial, Helvetica, sans-serif">Arial</option>');
			document.writeln('				<option value="Courier New, Courier, mono">Courier New</option>');
			document.writeln('				<option value="Times New Roman, Times, serif">Times New Roman</option>');
			//document.writeln('<option value="Verdana, Arial, Helvetica, sans-serif">Verdana</option>');
			document.writeln('			</select>');
			document.writeln('		</td>');
			

			document.writeln('		<td>');
			document.writeln('			<select unselectable="on" id="fontsize_' + rte + '" onchange="Select(\'' + rte + '\', this.id);">');
			document.writeln('				<option value="Size">Size</option>');
			document.writeln('				<option value="1">1</option>');
			document.writeln('				<option value="2">2</option>');
			document.writeln('				<option value="3">3</option>');
			document.writeln('				<option value="4">4</option>');
			document.writeln('			</select>');
			document.writeln('		</td>');
			document.writeln('	</tr>');
			document.writeln('</table>');
			

			document.writeln('<table id="Buttons2_' + rte + '" cellpadding="1" cellspacing="0">');
			document.writeln('	<tr>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'bold.gif" width="25" height="24" alt="Bold" title="Bold" onClick="FormatText(\'' + rte + '\', \'bold\', \'\')"></td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'italic.gif" width="25" height="24" alt="Italic" title="Italic" onClick="FormatText(\'' + rte + '\', \'italic\', \'\')"></td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'underline.gif" width="25" height="24" alt="Underline" title="Underline" onClick="FormatText(\'' + rte + '\', \'underline\', \'\')"></td>');
			document.writeln('		<td>&nbsp;</td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'left_just.gif" width="25" height="24" alt="Align Left" title="Align Left" onClick="FormatText(\'' + rte + '\', \'justifyleft\', \'\')"></td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'centre.gif" width="25" height="24" alt="Center" title="Center" onClick="FormatText(\'' + rte + '\', \'justifycenter\', \'\')"></td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'right_just.gif" width="25" height="24" alt="Align Right" title="Align Right" onClick="FormatText(\'' + rte + '\', \'justifyright\', \'\')"></td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'justifyfull.gif" width="25" height="24" alt="Justify Full" title="Justify Full" onclick="FormatText(\'' + rte + '\', \'justifyfull\', \'\')"></td>');
			document.writeln('		<td>&nbsp;</td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'numbered_list.gif" width="25" height="24" alt="Ordered List" title="Ordered List" onClick="FormatText(\'' + rte + '\', \'insertorderedlist\', \'\')"></td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'list.gif" width="25" height="24" alt="Unordered List" title="Unordered List" onClick="FormatText(\'' + rte + '\', \'insertunorderedlist\', \'\')"></td>');
			document.writeln('		<td>&nbsp;</td>');
			document.writeln('		<td><div id="forecolor_' + rte + '"><img class="btnImage" src="' + imagesPath + 'textcolor.gif" width="25" height="24" alt="Text Color" title="Text Color" onClick="FormatText(\'' + rte + '\', \'forecolor\', \'\')"></div></td>');
			document.writeln('		<td>&nbsp;</td>');
			document.writeln('		<td><img class="btnImage" src="' + imagesPath + 'hyperlink.gif" width="25" height="24" alt="Insert Link" title="Insert Link" onClick="FormatText(\'' + rte + '\', \'createlink\')"></td>');
			document.writeln('	</tr>');
			document.writeln('</table>');
		}
		document.writeln('<iframe id="' + rte + '" name="' + rte + '" width="' + width + 'px" height="' + height + 'px"></iframe>');
		if (!readOnly) document.writeln('<br /><input type="hidden" id="chkSrc' + rte + '" onclick="toggleHTMLSrc(\'' + rte + '\');" />');
		document.writeln('<iframe width="254" height="174" id="cp' + rte + '" src="' + includesPath + 'colorpallette.phtml" marginwidth="0" marginheight="0" scrolling="no" style="visibility:hidden; display: none; position: absolute;"></iframe>');
		document.writeln('<input type="hidden" id="hdn' + rte + '" name="' + rte + '" value="">');
		
		document.getElementById('hdn' + rte).value = html;
		enableDesignMode(rte, html, readOnly);
	}
	
	function enableDesignMode(rte, html, readOnly) {
		var frameHtml = "<html id=\"" + rte + "\">\n";
		frameHtml += "<head>\n";
		//to reference your stylesheet, set href property below to your stylesheet path and uncomment
		if (cssFile.length > 0) {
			frameHtml += "<link media=\"all\" type=\"text/css\" href=\"" + cssFile + "\" rel=\"stylesheet\">\n";
		}
		else {
			frameHtml += "<style type=\"text/css\">BODY { font-family: Verdana; font-size: 10pt; } </style>\n";
		}
		frameHtml += "<style>\n";
		frameHtml += "body {\n";
		frameHtml += "	background: #FFFFFF;\n";
		frameHtml += "	margin: 0px;\n";
		frameHtml += "	padding: 0px;\n";
		frameHtml += "}\n";
		frameHtml += "</style>\n";
		frameHtml += "</head>\n";
		frameHtml += "<body>\n";

		rExp2 = /\n/gi;
		html = html.replace(rExp2, "<br>\n");

		frameHtml += html + "\n";
		frameHtml += "</body>\n";
		frameHtml += "</html>";


		if (document.all) {
			var oRTE = frames[rte].document;
			oRTE.open();
			oRTE.write(frameHtml);
			oRTE.close();
			if (!readOnly) { 
			  oRTE.designMode = "On";
			  frames[rte].document.attachEvent("onkeypress", "function evt_ie_keypress(event) {ieKeyPress(event, rte);}");
			}
		}
		else {
			try {
				if (!readOnly) document.getElementById(rte).contentDocument.designMode = "on";
				try {
					var oRTE = document.getElementById(rte).contentWindow.document;
					oRTE.open();
					oRTE.write(frameHtml);
					oRTE.close();
					//oRTE.addEventListener("blur", updateRTE(rte), true);
					if (isGecko && !readOnly) {
						//attach a keyboard handler for gecko browsers to make keyboard shortcuts work
						oRTE.addEventListener("keypress", kb_handler, true);
					}
				} catch (e) {
					alert("Error preloading content.");
				}
			} catch (e) {
				//gecko may take some time to enable design mode.
				//Keep looping until able to set.
				if (isGecko) {
					setTimeout("enableDesignMode('" + rte + "', '" + html + "');", 10);
				} else {
					return false;
				}
			}
		}
	}
	
	function updateRTEs() {
		var vRTEs = allRTEs.split(";");
		for (var i = 0; i < vRTEs.length; i++) {
			updateRTE(vRTEs[i]);
		}
	}
	
	function updateRTE(rte) {
		//set message value
		var oHdnMessage = document.getElementById('hdn' + rte);
		var oRTE = document.getElementById(rte);
		var readOnly = false;
		
		//check for readOnly mode
				if (document.all) {
			if (frames[rte].document.designMode != "On") readOnly = true;
		} else {
			if (document.getElementById(rte).contentDocument.designMode != "on") readOnly = true;
			}
		
		if (isRichText && !readOnly) {
			//if viewing source, switch back to design view
			if (document.getElementById("chkSrc" + rte).checked) {
				document.getElementById("chkSrc" + rte).checked = false;
				toggleHTMLSrc(rte);
			}
			
			if (oHdnMessage.value == null) oHdnMessage.value = "";

			  rExp = /\r\n/ig;


			if (document.all) {
				oHdnMessage.value = frames[rte].document.body.innerHTML.replace(rExp, "");
				//oHdnMessage.value = frames[rte].document.body.innerHTML;
			} else {
				oHdnMessage.value = oRTE.contentWindow.document.body.innerHTML.replace(rExp, "");

			  //rExp = /<br[ ]*[\/]*>\r\n/ig;

				//oHdnMessage.value = oRTE.contentWindow.document.body.innerHTML.replace(rExp, "<br>");
			}
			//if there is no content (other than formatting) set value to nothing
			if (stripHTML(oHdnMessage.value.replace("&nbsp;", " ")) == "") oHdnMessage.value = "";
			//fix for gecko
			if (escape(oHdnMessage.value) == "%3Cbr%3E%0D%0A%0D%0A%0D%0A") oHdnMessage.value = "";
		}
	}

function showHideElement(element, showHide) {
  //function to show or hide elements
  //element variable can be string or object
  if (document.getElementById(element)) {
    element = document.getElementById(element);
  }
  
  if (showHide == "show") {
    element.style.visibility = "visible";
  } else if (showHide == "hide") {
    element.style.visibility = "hidden";
  }
}

function toggleHTMLSrc(rte) {
  //contributed by Bob Hutzel (thanks Bob!)
  var buttons = true;
  var oRTE;
  if (document.all) {
    oRTE = frames[rte].document;
  } else {
    oRTE = document.getElementById(rte).contentWindow.document;
  }
  
  if (document.getElementById("chkSrc" + rte).checked) {
      rExp = /<br[ ]*[\/]*>\r\n/gi;

    if (buttons) {
      showHideElement("Buttons1_" + rte, "hide");
      showHideElement("Buttons2_" + rte, "hide");
    }
    if (document.all) {
      //oRTE.body.innerText = oRTE.body.innerHTML;
      //oRTE.body.innerText = oRTE.body.innerHTML.replace(rExp, "<br>");
      oRTE.body.innerText = stripIEUgliness(oRTE.body.innerHTML);
    } else {
      var htmlSrc = oRTE.createTextNode(oRTE.body.innerHTML);
      oRTE.body.innerHTML = "";

      
      htmlSrc.nodeValue = stripIEUgliness(htmlSrc.nodeValue);
      //      htmlSrc.nodeValue = htmlSrc.nodeValue.replace(rExp, "<br>");

      oRTE.body.appendChild(htmlSrc);
    }
  } else {
    if (buttons) {
      showHideElement("Buttons1_" + rte, "show");
      showHideElement("Buttons2_" + rte, "show");
    }
    if (document.all) {
      //fix for IE
      var output = escape(oRTE.body.innerText);

      output = output.replace("%3CP%3E%0D%0A%3CHR%3E", "%3CHR%3E");
      output = output.replace("%3CHR%3E%0D%0A%3C/P%3E", "%3CHR%3E");

      oRTE.body.innerHTML = unescape(output);
    } else {
      var htmlSrc = oRTE.body.ownerDocument.createRange();
      htmlSrc.selectNodeContents(oRTE.body);
      oRTE.body.innerHTML = htmlSrc.toString();
    }
  }
}
/*	function toggleHTMLSrc(rte) {
		//contributed by Bob Hutzel (thanks Bob!)
		var oRTE;
		if (document.all) {
			oRTE = frames[rte].document;
		} else {
			oRTE = document.getElementById(rte).contentWindow.document;
		}
		
		if (document.getElementById("chkSrc" + rte).checked) {
			document.getElementById("Buttons1_" + rte).style.visibility = "hidden";
			document.getElementById("Buttons2_" + rte).style.visibility = "hidden";
			if (document.all) {
				oRTE.body.innerText = oRTE.body.innerHTML;
			} else {
				var htmlSrc = oRTE.createTextNode(oRTE.body.innerHTML);
				oRTE.body.innerHTML = "";
				oRTE.body.appendChild(htmlSrc);
			}
		} else {
			document.getElementById("Buttons1_" + rte).style.visibility = "visible";
			document.getElementById("Buttons2_" + rte).style.visibility = "visible";
			if (document.all) {
				oRTE.body.innerHTML = oRTE.body.innerText;
			} else {
				var htmlSrc = oRTE.body.ownerDocument.createRange();
				htmlSrc.selectNodeContents(oRTE.body);
				oRTE.body.innerHTML = htmlSrc.toString();
			}
		}
	}
*/	
	//Function to format text in the text box
	function FormatText(rte, command, option) {
		var oRTE;
		if (document.all) {
			oRTE = frames[rte];
			
			//get current selected range
			var selection = oRTE.document.selection; 
			if (selection != null) {
				rng = selection.createRange();
			}
		} else {
			oRTE = document.getElementById(rte).contentWindow;
			
			//get currently selected range
			var selection = oRTE.getSelection();
			rng = selection.getRangeAt(selection.rangeCount - 1).cloneRange();
		}
		
		try {
			if ((command == "forecolor") || (command == "hilitecolor")) {
				//save current values
				parent.command = command;
				currentRTE = rte;
				
				//position and show color palette
				buttonElement = document.getElementById(command + '_' + rte);
				document.getElementById('cp' + rte).style.left = getOffsetLeft(buttonElement) + "px";
				document.getElementById('cp' + rte).style.top = (getOffsetTop(buttonElement) + buttonElement.offsetHeight) + "px";
				if (document.getElementById('cp' + rte).style.visibility == "hidden") {
					document.getElementById('cp' + rte).style.visibility = "visible";
					document.getElementById('cp' + rte).style.display = "inline";
				} else {
					document.getElementById('cp' + rte).style.visibility = "hidden";
					document.getElementById('cp' + rte).style.display = "none";
				}
			} else if (command == "createlink") {
				var szURL = prompt("Enter your URL.  Remember, only Neopets links are allowed.  ;)", "http://www.neopets.com/");
				try {
					//ignore error for blank urls
					oRTE.document.execCommand("Unlink", false, null);
					oRTE.document.execCommand("CreateLink", false, szURL);
				} catch (e) {
					//do nothing
				}
			} else {
			  	oRTE.document.execCommand(command, false, option);
				//oRTE.focus();

				//if (command.toLowerCase() == "insertorderedlist" || command.toLowerCase() == "insertunorderedlist") {
				// if (document.all) {
				//   var oRTE = frames[rte].document;
				//   
				//   oRTE.body.innerHTML = stripIEUgliness(oRTE.body.innerHTML);
				// }
				//}
			}
		} catch (e) {
			alert(e);
		}
	}



function stripIEUgliness (html) {
  stripped = html;
  //  window.alert('in stripIEUgliness:\n\n' + stripped)

  rExp = />\r\n</gi;
  stripped = stripped.replace(rExp, "><");

  rExp = /<br[ ]*[\/]?>\r\n/gi;
  stripped = stripped.replace(rExp, "<br>");


  //  window.alert('out stripIEUgliness:\n\n' + stripped)
  return stripped;
}

	
	//Function to set color
	function setColor(color) {
		var rte = currentRTE;
		var oRTE;
		if (document.all) {
			oRTE = frames[rte];
		} else {
			oRTE = document.getElementById(rte).contentWindow;
		}
		
		var parentCommand = parent.command;
		if (document.all) {
			//retrieve selected range
			var sel = oRTE.document.selection; 
			if (parentCommand == "hilitecolor") parentCommand = "backcolor";
			if (sel != null) {
				var newRng = sel.createRange();
				newRng = rng;
				newRng.select();
			}
		} else {
			//oRTE.focus();
		}
		oRTE.document.execCommand(parentCommand, false, color);
		//oRTE.focus();
		document.getElementById('cp' + rte).style.visibility = "hidden";
		document.getElementById('cp' + rte).style.display = "none";
	}
	
	//Function to add image
	function AddImage(rte) {
		var oRTE;
		if (document.all) {
			oRTE = frames[rte];
			
			//get current selected range
			var selection = oRTE.document.selection; 
			if (selection != null) {
				rng = selection.createRange();
			}
		} else {
			oRTE = document.getElementById(rte).contentWindow;
			
			//get currently selected range
			var selection = oRTE.getSelection();
			rng = selection.getRangeAt(selection.rangeCount - 1).cloneRange();
		}
		
		imagePath = prompt('Enter Image URL:', 'http://');				
		if ((imagePath != null) && (imagePath != "")) {
			//oRTE.focus();
			oRTE.document.execCommand('InsertImage', false, imagePath);
		}
		//oRTE.focus();
	}
	
	function getOffsetTop(elm) {
		var mOffsetTop = elm.offsetTop;
		var mOffsetParent = elm.offsetParent;
		
		while(mOffsetParent){
			mOffsetTop += mOffsetParent.offsetTop;
			mOffsetParent = mOffsetParent.offsetParent;
		}
		
		return mOffsetTop;
	}
	
	function getOffsetLeft(elm) {
		var mOffsetLeft = elm.offsetLeft;
		var mOffsetParent = elm.offsetParent;
		
		while(mOffsetParent) {
			mOffsetLeft += mOffsetParent.offsetLeft;
			mOffsetParent = mOffsetParent.offsetParent;
		}
		
		return mOffsetLeft;
	}
	
	function Select(rte, selectname) {
		var oRTE;
		if (document.all) {
			oRTE = frames[rte];
			
			//get current selected range
			var selection = oRTE.document.selection; 
			if (selection != null) {
				rng = selection.createRange();
			}
		} else {
			oRTE = document.getElementById(rte).contentWindow;
			
			//get currently selected range
			var selection = oRTE.getSelection();
			rng = selection.getRangeAt(selection.rangeCount - 1).cloneRange();
		}
		
		var idx = document.getElementById(selectname).selectedIndex;
		// First one is always a label
		if (idx != 0) {
			var selected = document.getElementById(selectname).options[idx].value;
			var cmd = selectname.replace('_' + rte, '');
			oRTE.document.execCommand(cmd, false, selected);
			document.getElementById(selectname).selectedIndex = 0;
		}
		//oRTE.focus();
	}
	
	function kb_handler(evt) {
		var rte = evt.target.id;
		
		//contributed by Anti Veeranna (thanks Anti!)
		if (evt.ctrlKey) {
			var key = String.fromCharCode(evt.charCode).toLowerCase();
			var cmd = '';
			switch (key) {
				case 'b': cmd = "bold"; break;
				case 'i': cmd = "italic"; break;
				case 'u': cmd = "underline"; break;
			};
	
			if (cmd) {
				FormatText(rte, cmd, true);
				//evt.target.ownerDocument.execCommand(cmd, false, true);
				// stop the event bubble
				evt.preventDefault();
				evt.stopPropagation();
			}
	 	}
	}
	
	function docChanged (evt) {
		alert('changed');
	}
	
	function stripHTML(oldString) {
		var newString = oldString.replace(/(<([^>]+)>)/ig,"");
		
		//replace carriage returns and line feeds
		newString = escape(newString);
		newString = newString.replace("%0D%0A"," ");
		newString = newString.replace("%0A"," ");
		newString = newString.replace("%0D"," ");
		newString = unescape(newString);
		
		//trim string
		newString = trim(newString);
		
		return newString;
	}

	function trim(inputString) {
	   // Removes leading and trailing spaces from the passed string. Also removes
	   // consecutive spaces and replaces it with one space. If something besides
	   // a string is passed in (null, custom object, etc.) then return the input.
	   if (typeof inputString != "string") return inputString;
	   var retValue = inputString;
	   var ch = retValue.substring(0, 1);
		
	   while (ch == " ") { // Check for spaces at the beginning of the string
	      retValue = retValue.substring(1, retValue.length);
	      ch = retValue.substring(0, 1);
	   }
	   ch = retValue.substring(retValue.length-1, retValue.length);
		
	   while (ch == " ") { // Check for spaces at the end of the string
	      retValue = retValue.substring(0, retValue.length-1);
	      ch = retValue.substring(retValue.length-1, retValue.length);
	   }
		
		// Note that there are two spaces in the string - look for multiple spaces within the string
	   while (retValue.indexOf("  ") != -1) {
			// Again, there are two spaces in each of the strings
	      retValue = retValue.substring(0, retValue.indexOf("  ")) + retValue.substring(retValue.indexOf("  ")+1, retValue.length);
	   }
	   return retValue; // Return the trimmed string back to the user
	}

function ieKeyPress(evt, rte) {
  var key = (evt.which || evt.charCode || evt.keyCode);
  var stringKey = String.fromCharCode(key).toLowerCase();
    
  switch (key) {
  case 13:
    //insert <br> tag instead of <p>
    //change the key pressed to null
    evt.keyCode = 0;
    
    //insert <br> tag
    currentRTE = rte;
    insertHTML('<br>\n');


    //    if (document.all) {
    // var oRTE = frames[rte].document;
    // oRTE.body.innerHTML = stripIEUgliness(oRTE.body.innerHTML);
    //}



    break;
  }; 
}


function insertHTML(html) {
  //function to add HTML -- thanks dannyuk1982
  var rte = currentRTE;
  
  var oRTE;
  if (document.all) {
    oRTE = frames[rte];
  } else {
    oRTE = document.getElementById(rte).contentWindow;
  }

  oRTE.focus();
  if (document.all) {
    var oRng = oRTE.document.selection.createRange();
    oRng.pasteHTML(html);
    oRng.collapse(false);
    oRng.select();
  } else {
    oRTE.document.execCommand('insertHTML', false, html);
  }
}


</SCRIPT>

      <SCRIPT language=JavaScript>

  //checks to see if there is an illegal character accidentally or otherwise entered into the "recipient" field.
  function checkusername() {
    if (document.neomessage.recipient.value.indexOf("'") != -1){
      alert("The username in the 'To:' field is written incorrectly. Please check the name of the person you are writing.");
      return;
    } else {
      //      updateRTE('message_body');
      // document.neomessage.submit();
    }
  }

</SCRIPT>

      <SCRIPT name="JavaScript">

function check_all_boxes() {
  with ( document ) {
    for ( i = 0 ; i < messages.elements.length ; i++ ) {
      messages.elements[i].checked = true;
    }
  }
}

function update_buddy() {
  var selectedbuddyIndex = document.neomessage.neofriends.selectedIndex;
  var selectedbuddy = document.neomessage.neofriends.options[document.neomessage.neofriends.selectedIndex].value;


  if (selectedbuddyIndex === 0) {
    selectedbuddy = " ";
  }
  
  document.neomessage.recipient.value = selectedbuddy.split(' ')[0];
  
  reload_block_iframe(selectedbuddy); // mattw 2004-11-05
}

function update_title() {
  selectedbuddy = document.neomessage.message_type.options[document.neomessage.message_type.selectedIndex].text
  if ( selectedbuddy != 'notitle' ) {
    document.neomessage.subject.value = selectedbuddy
  } else {
    document.neomessage.subject.value = ""
  }
}

function textCounter(field, countfield, maxlimit) {
		if (field.value.length > maxlimit) {		// if too long...trim it!
			field.value = field.value.substring(0, maxlimit);
		} else {									// otherwise, update 'characters left' counter
			countfield.value = maxlimit - field.value.length;
		};
	};


</SCRIPT>

      <CENTER><A 
      href="http://www.neopets.com/neomessages.phtml?folder=Inbox"><IMG 
      height=25 src="Page_files/header1.gif" width=59 border=0></A> <A 
      href="http://www.neopets.com/neomessages.phtml?type=send"><IMG height=25 
      src="Page_files/header2.gif" width=57 border=0></A> <A 
      href="http://www.neopets.com/neomessages.phtml?type=folders"><IMG 
      height=25 src="Page_files/header4.gif" width=66 border=0></A> <A 
      href="http://www.neopets.com/neofriends.phtml"><IMG height=25 
      src="Page_files/header5.gif" width=87 border=0></A> <A 
      href="http://www.neopets.com/diary.phtml"><IMG height=25 
      src="Page_files/header6.gif" width=56 border=0></A> <A 
      href="http://www.neopets.com/listgreetings.phtml"><IMG height=25 
      src="Page_files/header7.gif" width=80 border=0></A> <A 
      href="http://www.neopets.com/block.phtml"><IMG height=25 
      src="Page_files/header8.gif" width=61 border=0></A> 
      <P><B>NeoMail<SUP>®</SUP> Web Messaging</B> 
      <P></CENTER>
      <CENTER><B>Send a NeoMail™</B> </CENTER>
      <P>
      <FORM name=neomessage onsubmit="updateRTE('message_body');" 
      action=process_neomessages.phtml method=post>
      <TABLE 
      style="BORDER-RIGHT: #000000 1px solid; BORDER-TOP: #000000 1px solid; BORDER-LEFT: #000000 1px solid; BORDER-BOTTOM: #000000 1px solid" 
      cellSpacing=0 cellPadding=4 width=540 align=center border=0>
        <TBODY>
        <TR>
          <TD style="BORDER-RIGHT: #000000 1px solid" vAlign=top width=220 
          bgColor=#c8e3ff><B style="FONT-SIZE: 9pt">To:</B></TD>
          <TD vAlign=top width=320 bgColor=#f6f6f6>
            <SCRIPT type=text/javascript>
function reload_block_iframe(username) {
	frames['block_frame'].location.href = "neomail_block_check.phtml?background=%23F6F6F6&recipient=" + username;
}
</SCRIPT>
            <INPUT maxLength=20 
            onchange=reload_block_iframe(document.neomessage.recipient.value); 
            name=recipient><BR><IFRAME id=block_frame 
            style="BORDER-RIGHT: 0px; PADDING-RIGHT: 0px; BORDER-TOP: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; BORDER-LEFT: 0px; PADDING-TOP: 0px; BORDER-BOTTOM: 0px" 
            name=block_frame src="Page_files/neomail_block_check.htm" 
            frameBorder=0 width=400 height=40>Blah.</IFRAME><SELECT 
            onchange=update_buddy() name=neofriends> <OPTION value="" 
              selected>Select a NeoFriend!</OPTION></SELECT><BR><FONT size=1>(type 
            their username, or select from your NeoFriends)</FONT> 
<BR><BR></TD></TR>
        <TR>
          <TD style="BORDER-RIGHT: #000000 1px solid" vAlign=top 
            bgColor=#c8e3ff><B style="FONT-SIZE: 9pt">Subject:</B></TD>
          <TD vAlign=top bgColor=#f6f6f6><INPUT maxLength=30 size=23 
            name=subject> <SELECT onchange=update_title() name=message_type> 
              <OPTION value=notitle selected>Select a preset title!</OPTION> 
              <OPTION>Random Chat</OPTION> <OPTION>Neopet Related</OPTION> 
              <OPTION>Blah</OPTION> <OPTION>I'm Bored</OPTION> <OPTION>Wanna 
              Trade?</OPTION> <OPTION>Can you help me?</OPTION> 
              <OPTION>Declaration of War!</OPTION> <OPTION>I'm funny 
              because...</OPTION> <OPTION>Wanna buy some pegs?</OPTION> 
              <OPTION>Meep</OPTION> <OPTION>I'm feeling poor</OPTION> <OPTION>I 
              just need a...</OPTION> <OPTION>Guess what I saw</OPTION> 
              <OPTION>Uggh</OPTION> <OPTION>heh</OPTION> <OPTION>It's my 
              birthday!</OPTION> <OPTION>My shop has...</OPTION> <OPTION>Wanna 
              join my guild?</OPTION> <OPTION>Help!</OPTION> 
              <OPTION>Jurples</OPTION> <OPTION>My Neohome is awesome</OPTION> 
              <OPTION>Pant Devil Strikes!</OPTION> <OPTION>Something has 
              Happened</OPTION> <OPTION>HELLO</OPTION> <OPTION>Yar!</OPTION> 
              <OPTION>Would you like some cheese?</OPTION> <OPTION>My guild is 
              nifty</OPTION> <OPTION>A long time ago...</OPTION> <OPTION>Ulch! 
              You have Neezles</OPTION> <OPTION>Bleh</OPTION> <OPTION>Tag! 
              You're IT</OPTION> <OPTION>Battledome Challenge!</OPTION> 
              <OPTION>So, anyway...</OPTION> <OPTION>LOL</OPTION> 
              <OPTION>EEEEEURGH!!!</OPTION> <OPTION>Eviscerate010 says 
              hi</OPTION> <OPTION>Eviscerate010 is ill 
            :(</OPTION></SELECT><BR><FONT size=1>(choose a preset or use your 
            own)</FONT> <BR><BR></TD></TR><BR><BR></TD></TR>
        <TR>
          <TD style="BORDER-RIGHT: #000000 1px solid" vAlign=top 
            bgColor=#c8e3ff><B style="FONT-SIZE: 9pt">Message:</B></TD>
          <TD style="BORDER-TOP: #000000 1px solid" vAlign=top 
            bgColor=#ffffff><SCRIPT language=JavaScript type=text/javascript>
 <!--
	   // on a loads, we need to populate recipient, subject, and the message
  	   document.neomessage.subject.value='';
	   document.neomessage.recipient.value='';
 		//Usage: initRTE(imagesPath, includesPath, cssFile)
			initRTE("http://images.neopets.com/neomail/", "", "");
		//Usage: writeRichText(fieldname, html, width, height, buttons)

			writeRichText('message_body', '', 400, 100, true, false); 
	//-->
	</SCRIPT>
            <NOSCRIPT>Please enable Javascript to use Advanced Neomail. You can 
            also disable Advanced Neomail in your <A 
            href="http://www.neopets.com/preferences.phtml"><STRONG>preferences</STRONG></A>.</NOSCRIPT> 
          </TD></TR></TBODY></TABLE>
      <P>
      <CENTER><INPUT onclick=checkusername(); type=submit value="Send a NeoMail™"></CENTER></FORM></TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD align=middle><BR><FONT class=sf color=#333333>THIS PAGE CONTAINS PAID 
      ADVERTISEMENTS</FONT>
      <P>
      <DIV id=bottomban><!--footerinc 247_300x250--><!--- start of neopets_300x250_(300x250)_247RealMediaAdTag --->
      <SCRIPT language=JavaScript1.1 src="">
</SCRIPT>

      <SCRIPT language=JavaScript>
<!--
if (parseFloat(navigator.appVersion) == 0) { document.write('<IFRAME WIDTH=300 HEIGHT=250 MARGINWIDTH=0 MARGINHEIGHT=0 HSPACE=0 VSPACE=0 FRAMEBORDER=0 SCROLLING=no BORDERCOLOR="#000000" SRC="http://network.realmedia.com/RealMedia/ads/adstream_sx.ads/neopets/300x250/ron/enttnstchlifwmnispshp/ss/a@x15"></iframe>');
}
// -->
</SCRIPT>
      <NOSCRIPT><A 
      href="http://network.realmedia.com/RealMedia/ads/click_nx.ads/neopets/300x250/ron/enttnstchlifwmnispshp/ss/a@x15?x"><IMG 
      src=""></A> </NOSCRIPT><!--- end of neopets_300x250_(300x250)_247RealMediaAdTag ---></DIV>
      <P><FONT class=sf color=#666666>NEOPETS, characters, logos, names and all 
      related indicia<BR>are trademarks of <A 
      href="http://www.neopets.com/aboutus.phtml"><FONT class=sf>Neopets, 
      Inc.,</A><FONT class=sf color=#666666> © 1999-2005.<BR>® denotes Reg. US 
      Pat. &amp; TM Office. All rights reserved.</FONT><BR><A class=sf 
      href="http://www.neopets.com/privacy.phtml">PRIVACY POLICY</A> | <A 
      class=sf href="http://www.neopets.com/safetytips.phtml">Safety Tips</A> | 
      <A class=sf href="http://www.neopets.com/contact.phtml">Contact Us</A> | 
      <A class=sf href="http://www.neopets.com/aboutus.phtml">About Us</A> | <A 
      class=sf href="http://www.neopets.com/presskit_form.phtml">Press Kit</A>
      <SCRIPT language=JavaScript><!--
if(navigator.appVersion.indexOf("MSIE")>0&&parseInt(navigator.appVersion)>=4){document.write(' | <a href="javascript:window.external.AddFavorite(document.location,document.title)"><font class=sf>Bookmark Us</a>');}
//-->
</SCRIPT>
       <BR><FONT class=sf>Use of this site signifies your acceptance of the <A 
      href="http://www.neopets.com/terms.phtml"><FONT class=sf>Terms and 
      Conditions</A><BR clear=all><BR><BR><!--
 host - www186.sjo.neopets.com
//--></FONT></FONT></FONT></FONT></P></TD></TR></TBODY></TABLE>
<SCRIPT language=JavaScript>
function tzCook() { 
	var today = new Date();
	var expire = new Date();
	expire.setTime(today.getTime() + 3600000*24*30);
	var cstr = "_tz="+escape(today.getTimezoneOffset()) + ";expires="+expire.toGMTString() + ";path=/;domain=.neopets.com;";
	document.cookie = cstr;
}
tzCook();
</SCRIPT>
</BODY></HTML>
